{% extends "admin/base.html" %}
{% block title %}Edit {{ department.name }}{% endblock %}

{% block content %}
<a href="{{ url_for('admin.department_detail', dept_id=department.id) }}" class="btn btn-secondary btn-sm mb-lg">‚Üê Back
    to Department</a>

<div class="glass-card" style="max-width: 700px;">
    <div class="mb-xl">
        <h1>Edit <span class="gradient-text">{{ department.name }}</span></h1>
        <p class="text-muted">Configure all department details</p>
    </div>

    <form method="POST" action="{{ url_for('admin.edit_department', dept_id=department.id) }}"
        enctype="multipart/form-data">
        {{ form.hidden_tag() }}

        <!-- Basic Info -->
        <h3 class="mb-md">Basic Information</h3>

        <div class="form-group">
            <label class="form-label">Department Name *</label>
            {{ form.name(class="form-control") }}
            {% for error in form.name.errors %}
            <p class="form-error">{{ error }}</p>
            {% endfor %}
        </div>

        <div class="form-group">
            <label class="form-label">Short Description</label>
            {{ form.short_description(class="form-control", placeholder="Brief one-liner about the department") }}
            {% for error in form.short_description.errors %}
            <p class="form-error">{{ error }}</p>
            {% endfor %}
        </div>

        <div class="form-group">
            <label class="form-label">Full Description</label>
            {{ form.description(class="form-control", placeholder="Detailed description of the department, its work, and
            what members do...") }}
            {% for error in form.description.errors %}
            <p class="form-error">{{ error }}</p>
            {% endfor %}
        </div>

        <!-- Image -->
        <h3 class="mb-md mt-xl">Department Image</h3>

        {% if department.image_path %}
        <div class="mb-md">
            <img src="{{ url_for('static', filename=department.image_path) }}" alt="{{ department.name }}"
                style="width: 100%; max-width: 300px; border-radius: var(--radius-md);">
        </div>
        {% endif %}

        <div class="form-group">
            <label class="form-label">Upload New Image</label>
            {{ form.image(class="form-control") }}
            {% for error in form.image.errors %}
            <p class="form-error">{{ error }}</p>
            {% endfor %}
        </div>

        <!-- Positions & Requirements -->
        <h3 class="mb-md mt-xl">Positions & Requirements</h3>

        <div class="form-group">
            <label class="form-label">Available Positions</label>
            {{ form.positions(class="form-control", placeholder="e.g., Lead, Developer, Designer (comma-separated)") }}
            <p class="text-muted mt-sm" style="font-size: 0.85rem;">Separate multiple positions with commas</p>
            {% for error in form.positions.errors %}
            <p class="form-error">{{ error }}</p>
            {% endfor %}
        </div>

        <div class="form-group">
            <label class="form-label">Requirements</label>
            {{ form.requirements(class="form-control", placeholder="Skills, experience, or qualifications needed...") }}
            {% for error in form.requirements.errors %}
            <p class="form-error">{{ error }}</p>
            {% endfor %}
        </div>

        <!-- Recruitment Schedule -->
        <h3 class="mb-md mt-xl">Recruitment Schedule</h3>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <div class="form-group">
                <label class="form-label">Start Date & Time</label>
                {{ form.recruitment_start(class="form-control") }}
                {% for error in form.recruitment_start.errors %}
                <p class="form-error">{{ error }}</p>
                {% endfor %}
            </div>

            <div class="form-group">
                <label class="form-label">End Date & Time</label>
                {{ form.recruitment_end(class="form-control") }}
                {% for error in form.recruitment_end.errors %}
                <p class="form-error">{{ error }}</p>
                {% endfor %}
            </div>
        </div>

        <!-- Status -->
        <h3 class="mb-md mt-xl">Status</h3>

        <div class="form-group">
            <label class="switch">
                {{ form.is_active() }}
                <span class="switch-slider"></span>
            </label>
            <span style="margin-left: 1rem;">Active (accepting applications)</span>
        </div>

        <!-- Submit -->
        <div class="flex gap-md mt-xl">
            <button type="submit" class="btn btn-primary btn-lg" style="flex: 1;">Save Changes</button>
            <a href="{{ url_for('admin.department_detail', dept_id=department.id) }}"
                class="btn btn-secondary btn-lg">Cancel</a>
        </div>
    </form>
</div>
{% endblock %}